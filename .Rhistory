replicate(10, metaMDS(x, autotransform = F, k = i + 1)$stress))
}
}
#NMDS.scree(Spp)
# --> Based on scree plot three dimensions will be sufficient for NMDS #
# MDS and plot stress using a Shepherd Plot #
MDS_22 = metaMDS(Spp_22, distance = "bray", k=2)
MDS_22$stress
stressplot(MDS_22)
goodness(MDS_22)
# --> Shepherd plots showcase a not perfect, but acceptable R^2 value #
# Create a frame for functional groups alongside species for NMDS graph #
species_groups = group_by(Data_22, Species, Type) %>% summarise()
# Extract  species scores & convert to a data.frame for NMDS graph #
species.scores <-
as.data.frame(vegan:::scores.metaMDS(MDS_22, display = c("species")))
# create a column of species, from the row names of species.scores  #
species.scores$species <- rownames(species.scores)
# create a column for functional groups for NMDS graph #
species.scores$Type <- species_groups$Type
# Turn MDS points into a dataframe with treatment data for use in ggplot #
NMDS_22 = data.frame(ID = Treat$ID, MDS_22 = MDS_22$points, Treatment = Treat$Treatment,
Sub_Plot = Treat$Sub_Plot)
# NMDS Graphs
NMDS_graph_22 =
ggplot() +
geom_point(data = NMDS_22, aes(x = MDS_22.MDS1, y = MDS_22.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 40, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_23$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2022") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_blank(),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y = element_blank(),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Fire Treatment",
fill = "Fire Treatment")
# NMDS Graphs
NMDS_graph_22 =
ggplot() +
geom_point(data = NMDS_22, aes(x = MDS_22.MDS1, y = MDS_22.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 20, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_22$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2022") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_blank(),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y = element_blank(),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Fire Treatment",
fill = "Fire Treatment")
NMDS_graph_22
# NMDS Graphs
NMDS_graph_22 =
ggplot() +
geom_point(data = NMDS_22, aes(x = MDS_22.MDS1, y = MDS_22.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 21, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_22$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2022") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_blank(),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y = element_blank(),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Fire Treatment",
fill = "Fire Treatment")
NMDS_graph_22
# NMDS Graphs
NMDS_graph_22 =
ggplot() +
geom_point(data = NMDS_22, aes(x = MDS_22.MDS1, y = MDS_22.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 25, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_22$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2022") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_blank(),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y = element_blank(),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Fire Treatment",
fill = "Fire Treatment")
NMDS_graph_22
# NMDS Graphs
NMDS_graph_22 =
ggplot() +
geom_point(data = NMDS_22, aes(x = MDS_22.MDS1, y = MDS_22.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 40, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_22$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2022") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_blank(),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y = element_blank(),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Fire Treatment",
fill = "Fire Treatment")
NMDS_graph_22
# NMDS Graphs
NMDS_graph_22 =
ggplot() +
geom_point(data = NMDS_22, aes(x = MDS_22.MDS1, y = MDS_22.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-0.9,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 40, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_22$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2022") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_blank(),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y = element_blank(),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Fire Treatment",
fill = "Fire Treatment")
NMDS_graph_22
# NMDS Graphs
NMDS_graph_22 =
ggplot() +
geom_point(data = NMDS_22, aes(x = MDS_22.MDS1, y = MDS_22.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
xlim(-1,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 40, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_22$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2022") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_blank(),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y = element_blank(),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Fire Treatment",
fill = "Fire Treatment")
NMDS_graph_22
ggsave("Figures/NMDS_22.PNG",
width = 10, height = 7)
# Perform adonis to test the significance of treatments#
adon.results <- adonis2(Spp_22 ~ Treatment, data = NMDS_22, method="bray")
print(adon.results)
pairwise.adonis<-pairwise.adonis2(Spp_22 ~ Treatment, data = NMDS_22)
pairwise.adonis
# Create species pivot table #
Spp_23 = dplyr::select(Data_23, ID, Species, Coverage) %>% matrify()
# Create grouped treatment/environment table and summaries to fit species table#
Treat = group_by(Data_23, ID, Treatment) %>% summarise()
NMDS.scree <- function(x) { # x is the name of the data frame variable
plot(rep(1, 10), replicate(10, metaMDS(x, autotransform = F, k = 1)$stress),
xlim = c(1, 10),ylim = c(0, 0.30), xlab = "# of Dimensions",
ylab = "Stress", main = "NMDS Stress Plot")
for (i in 1:10) {
points(rep(i + 1,10),
replicate(10, metaMDS(x, autotransform = F, k = i + 1)$stress))
}
}
# MDS and plot stress using a Shepherd Plot #
MDS_23 = metaMDS(Spp_23, distance = "bray", trymax = 500, maxit = 999, k=3,
trace = F, autotransform = FALSE, wascores = TRUE)
MDS_23$stress
stressplot(MDS_23)
goodness(MDS_23)
# Create a frame for functional groups alongside species for NMDS graph #
species_groups = group_by(Data_23, Species, Type) %>% summarise()
# Extract  species scores & convert to a data.frame for NMDS graph #
species.scores <-
as.data.frame(vegan:::scores.metaMDS(MDS_23, display = c("species")))
# create a column of species, from the row names of species.scores  #
species.scores$species <- rownames(species.scores)
# create a column for functional groups for NMDS graph #
species.scores$Type <- species_groups$Type
# Turn MDS points into a dataframe with treatment data for use in ggplot #
NMDS_23 = data.frame(MDS_23 = MDS_23$points, Treatment = Treat$Treatment,
Plot = Treat$ID)
# NMDS Graphs
NMDS_graph_23 =
ggplot() +
geom_point(data = NMDS_23, aes(x = MDS_23.MDS1, y = MDS_23.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 40, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_23$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2023") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_text(size=25, face="bold", colour = "black"),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_text(size=25, face = "bold", color = "black"),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Treatment",
fill = "Treatment")
NMDS_graph_23
# NMDS Graphs
NMDS_graph_23 =
ggplot() +
geom_point(data = NMDS_23, aes(x = MDS_23.MDS1, y = MDS_23.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
xlim(-1,1)
# NMDS Graphs
NMDS_graph_23 =
ggplot() +
geom_point(data = NMDS_23, aes(x = MDS_23.MDS1, y = MDS_23.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
xlim(-1,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 40, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_23$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2023") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_text(size=25, face="bold", colour = "black"),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_text(size=25, face = "bold", color = "black"),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Treatment",
fill = "Treatment")
NMDS_graph_23
# NMDS Graphs
NMDS_graph_23 =
ggplot() +
geom_point(data = NMDS_23, aes(x = MDS_23.MDS1, y = MDS_23.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 40, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_23$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2023") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_text(size=25, face="bold", colour = "black"),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_text(size=25, face = "bold", color = "black"),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Treatment",
fill = "Treatment")
NMDS_graph_23
# NMDS Graphs
NMDS_graph_23 =
ggplot() +
geom_point(data = NMDS_23, aes(x = MDS_23.MDS1, y = MDS_23.MDS2, fill = Treatment),
alpha = 0.7, size = 5, shape = 21) +
ylim(-1,1) +
geom_segment(aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
data = species.scores, linewidth =1, alpha = 0.5, colour = "black") +
geom_text_repel(data = species.scores, aes(x = NMDS1, y = NMDS2),
label = species.scores$species, colour = "black", fontface = "bold",
max.overlaps = 40, force = 1) +
scale_color_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
scale_fill_manual(labels=c('BH', 'BM', 'LH', 'LM', 'W', "C"),
values=c("#663333", "#FF9966", "#006600", "#99FF99", "#CC0000", "#330099")) +
annotate("text", x = -1, y = 1,
label = paste0("Stress: ", format(MDS_23$stress, digits = 2)),
hjust = 0, size = 8) +
ggtitle("2023") +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, color="black",
size=25, face="bold"),
axis.title.x = element_text(size=25, face="bold", colour = "black"),
axis.title.y = element_text(size=25, face="bold", colour = "black"),
axis.text.x=element_text(size=25, face = "bold", color = "black"),
axis.text.y=element_text(size=25, face = "bold", color = "black"),
legend.text=element_text(size=25, face = "bold", color = "black"),
legend.title=element_text(size=25, face = "bold", color = "black"),
legend.position="bottom") +
guides(fill = guide_legend(label.position = "bottom")) +
labs(x = "MDS1", y = "MDS2", color = "Treatment",
fill = "Treatment")
NMDS_graph_23
ggsave("Figures/NMDS_23.png",
width = 10, height = 7)
island.spp_cor <-
cor(Spp_23,
MDS_23$points,
use = "complete.obs",
method = "pearson")
write.csv(island.spp_cor, file = "Figures/island_spp_PearsonCor.csv")
# Perform adonis to test the significance of treatments#
adon.results <- adonis2(Spp_23 ~ NMDS_23$Treatment, method="bray",perm=999)
print(adon.results)
pairwise.adonis<-pairwise.adonis2(Spp_23 ~ Treatment, data = NMDS_23)
pairwise.adonis %>% as.data.frame() %>% write.csv(file = "Figures/adonis_2023.csv")
options(knitr.kable.NA = '',  col.names = 1) # this will hide missing values in the kable table
g = kable(pairwise.adonis, digits = 3) # the digits argument controls rounding
table
################## Save Figures Above using ggarrange ##########################
NMDS_22_23 =
ggarrange(NMDS_graph_22, NMDS_graph_23, ncol = 2, nrow = 1,
common.legend = TRUE, legend="bottom")
NMDS_22_23
ggsave("Figures/22-23_NMDS.png",
width = 18, height = 10)
